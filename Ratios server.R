observeEvent(input$top,
             if((input$top + input$bottom) > 100){
               updateNumericInput(session, "bottom", value = 100 - input$top)
             }
)

observeEvent(input$bottom,
             if((input$bottom + input$top) > 100){
               updateNumericInput(session, "top", value = 100 - input$bottom)
             }
)



ratdist <- reactiveValues(ratdistvec = c())

observeEvent(input$ratiodata,
             if(substr(input$ratiodata, 1, 1) == "T") { ratdist$ratdistvec = incomeuk1819 #GDP
             } else if(substr(input$ratiodata, 1, 1) == "G") { 
               ratdist$ratdistvec = gdp2017 #Suicide
             } else if(substr(input$ratiodata, 1, 1) == "S") { 
               ratdist$ratdistvec = suicide2016 #Homicide
             } else if(substr(input$ratiodata, 1, 1) == "I") { 
               ratdist$ratdistvec = homicide #Medals
             } else if(substr(input$ratiodata, 1, 1) == "A") { 
               ratdist$ratdistvec = allmedals #Medals
             } else stop("something is wrong")
)


#boxes
output$palma_ratio <- 
  renderValueBox({ valueBox( round(palma(ratdist$ratdistvec), 3), 
                   "Palma Ratio", color = 'lime' ) })

output$quintile_ratio <- 
  renderValueBox({ valueBox( round(quintile(ratdist$ratdistvec), 3), 
                   "S80-S20 Ratio", color = 'lime' ) })

output$decile_ratio <- 
  renderValueBox({ valueBox( round(pratio(ratdist$ratdistvec, "p90p10"), 3), 
                   "P90-P10 Ratio", color = 'lime' ) })

output$tenfifty_ratio <- 
  renderValueBox({ valueBox( round(pratio(ratdist$ratdistvec, "p50p10"), 3), 
                   "P50-P10 Ratio", color = 'lime' ) })

output$own_ratio <- renderValueBox({ input$action 
                                     input$ratiodata
                                     isolate(valueBox( round(ownratio(ratdist$ratdistvec, input$bottom, input$top), 3), 
                                     "Own Ratio", color = 'lime' )) })

#plot
output$ratio_out1 <- renderPlot({
  input$action
  isolate(ggratio(ratdist$ratdistvec, input$bottom, input$top))
})


#----------------------- Sample Data as vectors

allmedals <- c(2825, 1757, 1339, 883, 840, 701, 652, 608, 571, 524, 521, 500, 498, 497, 470, 415, 
               345, 337, 319, 307, 306, 226, 224, 195, 168, 154, 154, 129, 129, 120, 116, 103, 
               98, 97, 91, 91, 86, 78, 74, 71, 69, 69, 56, 54, 44, 42, 41, 40, 36, 33, 33, 32, 32, 31, 31,
               28, 28, 28, 26, 25, 25, 24, 24, 23, 19, 17, 17, 17, 15, 14, 14, 13, 13, 11, 10, 10, 10, 
               9, 9, 8, 7, 7, 6, 5, 5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 
               2, 2, 2, 2, 2, 2 ,2, 2, 2, 1, 1, 1, 1, 1, 1, 1 ,1 ,1, 1, 1, 1, 1 ,1, 1, 1, 1, 1, 1, 1, 
               1, 1, 1, 1)


suicide2016 <- c(6.4, 5.6, 3.3, 8.9, 0.5, 9.1, 5.7, 11.7, 11.4, 2.6, 1.6, 5.7, 6.1, 0.4, 21.4, 15.7, 
                 5.9, 15.7, 11.6, 12.9, 6.4, 11.5, 6.1, 4.5, 7.9, 14.8, 15, 15.1, 5.9, 19.5, 10.4, 11.6, 
                 15.5, 9.7, 8, 7, 11.1, 9.3, 7.5, 23, 11.5, 10.1, 4.5, 10.5, 10.6, 9.7, 9.2, 8.5, 10.5, 7.2, 
                 4.4, 13.5, 22, 13.8, 14.4, 16.7, 11.4, 5.5, 13.8, 12.1, 9.6, 10, 6.7, 9.1, 8.7, 3.8, 1.7, 
                 2.9, 10.5, 7.4, 30.2, 12.2, 3.4, 13.6, 13.3, 16.5, 3.7, 4, 4.1, 10.9, 5.2, 5.5, 2, 14.3, 3.7, 
                 22.8, 5.6, 15.2, 2.2, 9.1, 9.3, 17.2, 3.2, 28.9, 13.4, 5.5, 25.7, 10.4, 6.9, 7.8, 6.2, 2.7, 
                 8.9, 6.5, 7.5, 7.3, 5.2, 11.3, 13.3, 7.9, 3.1, 8.4, 8.1, 11.5, 9.6, 9.6, 11.6, 11.9, 9, 17.3, 
                 10.1, 3.5, 3.1, 4.4, 7, 9.3, 5.1, 3.7, 13.4, 8.6, 5.8, 20.2, 13.4, 6.2, 8, 26.5, 11, 7.3, 2.4, 
                 5.4, 3.1, 3.4, 11.8, 10.9, 8.3, 16.1, 7.9, 10.1, 13.3, 5.9, 8.3, 12.8, 6.1, 6.1, 14.2, 9.5, 
                 23.2, 11.7, 11.3, 2.4, 3.3, 12.9, 6.4, 16.6, 4, 12.9, 3.2, 7.2, 7.2, 20, 18.5, 2.7, 7.6, 9.6, 
                 13.7, 16.5, 7.4, 5.4, 3.8, 7, 9.8, 11.3, 19.1)

gdp2017 <- c(619, 4.450, 4.055, 39.153, 4.247, 18.861, 14.803, 14.400, 3.937, 25.655, 57.613, 47.718, 4.146, 29.825, 
             23.668, 1.492, 16.494, 5.750, 43.289, 5.077, 826, 102.192, 3.173, 3.394, 5.181, 7.596, 9.821, 31.917, 28.291, 
             8.218, 642, 290, 3.245, 1.382, 1.452, 44.974, 65.472, 428, 719, 15.347, 8.682, 46.390, 80.893, 6.302, 1.330, 
             2.147, 17.798, 11.734, 1.566, 13.177, 8.433, 25.790, 20.326, 685, 463, 57.533, 1.928, 6.719, 7.052, 6.273, 2.000, 
             3.889, 9.850, 1.147, 19.793, 3.224, 720, 5.382, 45.670, 38.415, 19.807, 7.221, 709, 3.875, 44.976, 2.046, 18.198, 
             49.398, 10.451, 4.471, 803, 724, 4.555, 776, 2.480, 14.376, 73.060, 1.923, 3.847, 5.680, 4.756, 69.604, 42.452, 
             32.747, 5.130, 38.220, 4.196, 8.756, 1.508, 1.694, 4.116, 28.897, 1.251, 2.457, 15.625, 8.778, 1.178, 584, 3.942, 
             166.022, 16.450, 106.806, 517, 340, 9.951, 11.151, 822, 29.137, 3.753, 1.129, 10.565, 8.967, 3.188, 165.421, 3.620, 
             7.703, 11.582, 3.070, 426, 1.257, 5.227, 10.045, 849, 48.754, 35.815, 42.935, 2.222, 378, 1.969, 5.415, 75.295, 15.267, 
             1.534, 13.417, 15.088, 2.667, 4.322, 6.572, 2.989, 13.786, 18.882, 28.451, 63.506, 30.025, 2.006, 10.763, 10.956, 748, 
             16.818, 9.607, 7.099, 4.356, 50.588, 1.921, 20.761, 1.333, 5.912, 15.693, 495, 56.737, 17.552, 23.296, 1.982, 104, 6.151, 
             453, 28.354, 4.184, 2.946, 2.967, 6.757, 54.043, 80.101, 831, 801, 6.595, 2.279, 614, 3.950, 16.145, 3.475, 10.546, 6.585, 
             28.689, 3.924, 646, 2.536, 40.699, 39.758, 934, 60.055, 17.120, 1.557, 3.128, 7.977, 2.342, 990, 1.513, 920, 1.091)

homicide <- c(6.3, 2.7, 1.4, 5.4, 1.2, 4.8, 27.7, 10.3, 5.9, 3.0, 1.9, 0.9, 1.0, 0.7, 2.1, 28.4, 0.5, 
              2.5, 10.9, 3.6, 1.9, 37.6, 6.2, 13.0, 1.1, 6.3, 1.3, 15.0, 29.5, 8.4, 0.5, 1.1, 0.4, 6.0, 
              11.6, 11.5, 1.8, 4.2, 1.7, 8.4, 19.8, 9.0, 0.0, 3.5, 0.6, 0.4, 0.2, 25.5, 7.7, 9.3, 3.5, 11.9, 
              1.0, 5.0, 19.2, 1.1, 0.6, 4.4, 13.5, 1.0, 6.5, 8.4, 15.2, 5.9, 2.5, 82.8, 2.3, 8.0, 3.2, 17.3, 
              7.6, 2.3, 1.4, 1.4, 13.2, 0.4, 8.0, 9.1, 1.0, 1.2, 1.7, 3.0, 0.8, 5.3, 10.2, 8.0, 2.5, 27.3, 
              8.8, 9.5, 18.4, 10.0, 0.0, 56.5, 2.1, 0.3, 3.2, 0.5, 2.5, 9.9, 0.8, 0.0, 1.4, 0.7, 47.0, 0.3, 
              1.5, 4.8, 4.9, 7.5, 1.6, 1.8, 4.5, 7.0, 3.4, 4.0, 41.2, 3.2, 2.5, 0.0, 5.2, 0.7, 7.7, 1.7, 2.1, 
              0.8, 10.9, 0.9, 2.8, 9.9, 1.8, 5.9, 19.3, 4.7, 0.0, 5.7, 4.5, 19.9, 1.2, 3.4, 2.3, 17.1, 0.0, 2.2, 
              0.6, 3.2, 1.0, 7.4, 4.4, 9.8, 0.0, 1.6, 0.5, 0.7, 0.8, 4.4, 3.1, 9.7, 7.8, 9.3, 7.7, 11.0, 0.7, 0.6, 
              18.5, 0.4, 1.8, 0.7, 3.2, 1.2, 10.8, 2.5, 0.0, 34.2, 19.3, 15.9, 36.5, 3.1, 0.0, 3.4, 1.5, 7.4, 1.4, 
              12.7, 1.7, 0.3, 1.0, 0.5, 3.8, 4.3, 34.0, 13.9, 0.6, 2.5, 0.7, 5.2, 8.3, 1.1, 0.5, 2.2, 1.6, 3.2, 3.9, 
              9.0, 1.0, 30.9, 3.0, 4.3, 4.2, 5.9, 18.6, 11.5, 6.3, 0.9, 1.2, 7.0, 5.4, 49.3, 7.7, 3.0, 2.1, 56.3, 1.5, 
              6.7, 5.3, 6.7)

incomeuk1819 <- c(11.000,11.700,11.900,12.200,12.400,12.600,12.800,12.900,13.100,13.300,13.500,13.700,13.900,14.000,14.200,
                  14.400,14.600,14.800,15.000,15.200,15.400,15.500,15.700,15.900,16.100,16.300,16.500,16.700,16.900,
                  17.100,17.300,17.500,17.700,17.900,18.100,18.300,18.600,18.800,19.000,19.200,19.500,19.700,20.000,
                  20.200,20.500,20.700,21.000,21.200,21.500,21.800,22.100,22.400,22.700,23.000,23.300,23.600,23.900,
                  24.300,24.600,25.000,25.300,25.700,26.100,26.400,26.800,27.300,27.700,28.100,28.600,29.100,29.600,
                  30.100,30.600,31.200,31.700,32.300,33.000,33.700,34.300,35.000,35.800,36.600,37.500,38.300,39.200,
                  40.100,41.100,42.000,42.900,44.100,45.500,47.200,49.300,51.800,55.100,59.300,65.100,73.000,84.500,
                  116.000)



